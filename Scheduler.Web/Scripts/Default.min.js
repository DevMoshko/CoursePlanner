function setCaretPosition(n,t){var i=document.getElementById(n),r;i!=null&&(i.createTextRange?(r=i.createTextRange(),r.move("character",t),r.select()):i.selectionStart?(i.focus(),i.setSelectionRange(t,t)):i.focus())}function selectAll(n){document.getElementById(n).focus(),document.getElementById(n).select()}function layout(){$("#pageWrapper").height($(window).height()-85),$("#searchBox").width($("#sideBar").width()-80),$("#resultView").css("min-width",$("#searchBox").width()),$("#calendarViews").width($(window).width()-$("#sideBar").width()-32),$("#calendarViews").height($(window).height()-90),$("#sideBar").height($("#calendarViews").height()),$("#courseList").height($("#sideBar").height()-68),calendar&&calendar.resize()}function searchCourse(n){var o;$("#searchBox").hasClass("searchTip")&&$("#searchBox").removeClass("searchTip"),n=n.replace("("," ").replace(")"," ");var f="",e="",r="",u="",t="",i="";$("#fall").attr("checked")!=="checked"&&(f+=" -sems:fall"),$("#winter").attr("checked")!=="checked"&&(f+=" -sems:winter"),$("#year").attr("checked")!=="checked"&&(f+=" -sems:year"),$("#enableUtsg").attr("checked")==="checked"&&(o="",e="camp:utsg",$("#artsci").attr("checked")!=="checked"&&(t+=" -fac:artsci"),$("#engineer").attr("checked")!=="checked"&&(t+=" -fac:engineering"),$("#cs").attr("checked")==="checked"&&(o+=" cat:cs"),$("#hss").attr("checked")==="checked"&&(o+=" cat:hss"),e+=o),i+=e===""?"":" "+e,$("#enableUtsc").attr("checked")==="checked"&&(r="camp:utsc"),i+=i===""?r===""?"":" "+r:r===""?"":"|"+r,$("#enableUtm").attr("checked")==="checked"&&(u="camp:utm",$("#sci").attr("checked")!=="checked"&&(t+=" -cat:sci"),$("#ssc").attr("checked")!=="checked"&&(t+=" -cat:ssc"),$("#hum").attr("checked")!=="checked"&&(t+=" -cat:hum")),i+=i===""?u===""?"":" "+u:u===""?"":"|"+u,n.length>1&&(loadingOn($("#courseWrapper")),$.getJSON("api/course?q="+escape(n+i+t+f),function(n){new ResultView($("#resultView")[0],n),loadingOff()}))}function searchCourseCode(n){var t=$(n).text();$("#searchBox").val(t),searchCourse(t)}function searchProgram(n){if(programInfo){var u="",i="",r="",t="";$("#enableUtsg").attr("checked")==="checked"&&(u="camp:utsg"),t+=u===""?"":" "+u,$("#enableUtsc").attr("checked")==="checked"&&(i="camp:utsc"),t+=t===""?i===""?"":" "+i:i===""?"":"|"+i,$("#enableUtm").attr("checked")==="checked"&&(r="camp:utm"),t+=t===""?r===""?"":" "+r:r===""?"":"|"+r,n.length>1&&(loadingOn($("#programWrapper")),$.getJSON("api/program?q="+escape(n+t),programInfo.loadSearches))}}function searchCourseInfo(n,t){$.getJSON("api/course?id="+parseInt(n.substring(1)),function(n){courseInfo=new CourseInfo($("#courseInfo"),n,t)})}function searchCourseCodeCallback(n,t){$.getJSON("api/course?raw=true&q=code:"+n,t)}function searchCourseInfoCallback(n,t){$.getJSON("api/course?id="+n,t)}function searchProgramInfo(n){$.getJSON("api/program?id="+parseInt(n.substring(1)),function(n){programInfo.loadProgram(n)})}function loadingOn(n){$(".loading").remove(),n.append("<img class='loading' src='/Images/ajax-loader.gif' style='float:right;'/>")}function loadingOff(){$(".loading").remove()}function ResultView(n,t){this.placeholder=n,this.result=t,this.formatElements(n,t),$(this.placeholder).parent().show("blind",100)}function MatchCollection(n,t,i){this.placeholder=n;var r="";t!==""&&(r+="<div class='matchCollectionTitle'>"+t+"<\/div>"),r+="<ul>"+i+"<\/ul>",$(this.placeholder).html(r),$(this.placeholder).children(".matchCollectionTitle").click(this.onTitleClick),$(this.placeholder).children("ul").children(".courseResult").click(function(n){searchCourseInfo($(n.target).attr("id"),$(n.target)),$(".courseResult.selected").removeClass("selected"),$(this).addClass("selected")})}function CourseInfo(n,t,i){var r,u;this.course=t,this.placeholder=n,this.animationLock=!1,$(this.placeholder).html(this.getHtml(this.course)),$(this.placeholder).css("left",$(i).offset().left+$(i)[0].outerWidth+20),r=$(i).offset().top,r+$(this.placeholder).height()>$(window).height()-10?(u=r-$(this.placeholder).height()+$(i).height()-16,u<0?$(this.placeholder).css("top",r-$(this.placeholder).height()/2+10):$(this.placeholder).css("top",u)):$(this.placeholder).css("top",r),$(".section").hover(function(n){this.fade(),courseInfo.addSection($(n.delegateTarget).attr("order"),!1)}.bind(this),function(){calendar.tempRemove()}.bind(this)),$(".sectionDiv").hover(function(){this.fade()}.bind(this),function(){this.notFade()}.bind(this)),$(".section").click(function(){$(this).hasClass("added")?courseInfo.removeSection($(this).attr("order")):courseInfo.addSection($(this).attr("order"),!0)}),this.refreshConflict()}function getSectionObject(n,t,i,r){var f=n.Sections[t].ParsedTime.MeetTimes,u={};return u.Abbr=n.Abbr+" "+n.Sections[t].Name,u.Name=n.Abbr+": "+n.Name+" "+n.Sections[t].Name,u.ShortName=n.Abbr+": "+n.Name,u.SectionName=n.Sections[t].Name,u.ID=r,u.CourseID=n.ID,u.Semester=n.Semester,u.Time=n.Sections[t].ParsedTime.StringFormat,u.Location=n.Sections[t].Location,f[i]&&(u.Day=f[i].Day,u.StartTime=f[i].Start,u.EndTime=f[i].End),u.Order=i,u.Campus=n.Campus,u}function ProgramInfo(n){this.placeholder=n,$(this.placeholder).append("<div id='programSearchResult'><\/div>"),$(this.placeholder).append("<div id='programDetail'><\/div>"),$("#programSearchBox").val()!==""&&searchProgram($("#programSearchBox").val())}function getUrlParameters(){for(var t={},n,r=/\+/g,u=/([^&=]+)=?([^&]*)/g,i=function(n){return decodeURIComponent(n.replace(r," "))},f=window.location.search.substring(1);n=u.exec(f);)t[i(n[1])]=i(n[2]);return t}function CoursesList(n){this.placeholder=n,$(this.placeholder).append("<div id='coursesListTitle' class='widgetTitle'><\/div><div id='courseList'><\/div>"),this.items={},this.courses={},this.creditCount=0,this.courseCount=0}function setCookie(n,t,i){var r=new Date,u;r.setDate(r.getDate()+i),u=escape(t)+(i==null?"":"; expires="+r.toUTCString()),document.cookie=n+"="+u}function getCookie(n){for(var r,u,i=document.cookie.split(";"),t=0;t<i.length;t++)if(r=i[t].substr(0,i[t].indexOf("=")),u=i[t].substr(i[t].indexOf("=")+1),r=r.replace(/^\s+|\s+$/g,""),r==n)return unescape(u)}function readCookieAddCourse(){var n=Base64.decode(getCookie("AddedCourses"));readStringAddCourse(n)}function readStringAddCourse(n){var i,r,t;if(n)for(i=n.split(","),r={},t=0;t<i.length;t++){var u=i[t].split(" "),f=u[0],e=u[1];searchCourseCodeCallback(f,function(n){return function(t){function i(i){var u=t[i].cid;r[u+n]=!0,searchCourseInfoCallback(u,function(n){for(var t=0,u,f,i=0;i<n.Sections.length;i++)if(r[n.ID+n.Sections[i].Name]&&(t=i,n.Sections[t].ParsedTime.MeetTimes&&(u=getSectionObject(n,t,0,n.ID+n.Sections[t].Name),!calendar.hasItem(u))))for(coursesList.addItem(u),f=0;f<n.Sections[t].ParsedTime.MeetTimes.length;f++)u=getSectionObject(n,t,f,n.ID+n.Sections[t].Name),calendar.addItem(u)})}i(0)||i(1)}}(e))}}function refreshCookie(){setCookie("AddedCourses",calendar.getAllSectionsString(),100)}var searchStringTemp="",progSearchStringTemp="",onAnimation=!1,calendar,courseInfo,coursesList,programInfo,isSearching;$(document).ready(function(){function i(n){switch(n){case"utsg":$("#enableUtsg").attr("checked","checked"),$("#enableUtsc").removeAttr("checked"),$("#enableUtm").removeAttr("checked");break;case"utsc":$("#enableUtsc").attr("checked","checked"),$("#enableUtsg").removeAttr("checked"),$("#enableUtm").removeAttr("checked");break;case"utm":$("#enableUtm").attr("checked","checked"),$("#enableUtsc").removeAttr("checked"),$("#enableUtsg").removeAttr("checked")}}var n=getCookie("Campus"),t;n&&n!==""?(i(n),$("#campusDialog").hide()):$("#campusDialog").dialog({height:180,modal:!0,buttons:[{text:"Enter Griddy",click:function(){$(this).dialog("close"),i($("#campusSelect").val()),$("#rememberCampus").attr("checked")==="checked"&&setCookie("Campus",$("#campusSelect").val(),10)}}]}),$(window).resize(layout),coursesList=new CoursesList(document.getElementById("addedCoursesList")),calendar=new CalendarCollection(document.getElementById("calendarViews"),coursesList),programInfo=new ProgramInfo(document.getElementById("programInfo")),$("#searchBox").keydown(function(){$(this).hasClass("searchTip")&&($(this).val(""),$(this).removeClass("searchTip"))}),$("#searchBox").keyup(function(){searchStringTemp=$("#searchBox").val(),setTimeout(function(){$("#searchBox").val()===searchStringTemp&&searchCourse(searchStringTemp)},300)}),$("#searchBox").focus(function(){$(this).hasClass("searchTip")||selectAll("searchBox"),$(".matchCollection").length>0&&$("#resultViewWrapper").show("blind",100)}),$("#searchBox").focus(),$("#searchBox").addClass("searchTip"),$("#searchBox").val("Search Courses"),setCaretPosition("searchBox",0),$("#programSearchBox").addClass("searchTip"),$("#programSearchBox").val("Search Programs"),$("#programSearchBox").keydown(function(){$(this).hasClass("searchTip")&&($(this).val(""),$(this).removeClass("searchTip"))}),$("#programSearchBox").keyup(function(){progSearchStringTemp=$("#programSearchBox").val(),setTimeout(function(){$("#programSearchBox").val()===progSearchStringTemp&&searchProgram(progSearchStringTemp)},300)}),$("#programSearchBox").focus(function(){$(this).hasClass("searchTip")||selectAll("programSearchBox")}),$(document).click(function(n){$(n.target).attr("id")!=="courseInfo"&&$(n.target).parents("#courseInfo").length==0&&$(n.target).parents("#sideBar").length==0&&($(n.target).hasClass("calendarItem")||$(n.target).parents(".calendarItem").length!=0||($("#courseInfo").hide("slide",200),$("#resultViewWrapper").hide("blind",100),$(".courseResult.selected").removeClass("selected"),$("#courseList").children(".selected").removeClass("selected"),$(".highlight").removeClass("highlight")),$(n.target).attr("id")!=="programInfoButton"&&$(n.target).attr("id")!==""&&$(n.target).parents("#programInfo").length==0&&($("#programInfo").hide("blind",100),$("#programInfoButton").removeClass("expand"))),$(n.target).attr("id")!=="advancedButton"&&$(n.target).attr("id")!=="advancedOptions"&&$(n.target).parents("#advancedOptions").length==0&&($("#advancedOptions").hide("blind",100),$("#advancedButton").removeClass("expand")),$(n.target).hasClass("calendarItem")||!$(n.target).parents(".calendarItem").length!=0||$(n.target).attr("id")==="calItemInfo"||$(n.target).parents("#calItemInfo").length!=0||$("#calItemInfo").hide()}),$("#programInfoButton").click(function(){$(this).hasClass("expand")?($("#programInfo").hide("blind",100),$(this).removeClass("expand")):($("#programInfo").css("left",$(window).width()-$("#programInfo").width()-23),$("#programInfo").show("blind",100),$(this).addClass("expand")),$("#programSearchBox").focus(),setCaretPosition("programSearchBox",0)}),$("#advancedButton").click(function(){$(this).hasClass("expand")?($("#advancedOptions").hide("blind",100),$(this).removeClass("expand")):($("#advancedOptions").css("left",$("#advancedButton").offset().left-168),$("#advancedOptions").show("blind",100),$(this).addClass("expand"),$("#programInfo").hide("blind",100),$("#programInfoButton").removeClass("expand"))}),$(".options").click(function(){$("#searchBox").val()!=="Search Courses"&&searchCourse($("#searchBox").val()),searchProgram($("#programSearchBox").val())}),$("#advancedOptionsTabs").tabs(),$.ajax({url:"Handlers/UpdateHandler.ashx"}).done(function(n){$("#updateTime").html(n)}),layout(),t=getUrlParameters().link,t?readStringAddCourse(Base64.decode(t)):readCookieAddCourse()}),ResultView.prototype.formatElements=function(n,t){function i(t,i,r,u){t&&($(n).append("<div class='matchCollection"+(u?" collapsed":"")+"' id='"+i+"'><\/div>"),new MatchCollection($("#"+i),r,t))}$(n).html(""),i(t.CodeNameMatches,"codeNameMatches","",!1),i(t.PostrequisiteMatches,"postMatches","Relevant Prerequisite",!1),i(t.DescriptionMatches,"desMatches","Relevant Description",!0),i(t.DepartmentMatches,"depMatches","Relevant Department",!0),i(t.PrerequisiteMatches,"preqMatches","Relevant Postrequisite",!0),i(t.RawMatches,"rawMatches","Other Relevant Courses",!0),$(".matchCollection.collapsed").height(20)},MatchCollection.prototype.onTitleClick=function(n){var r=$(n.target),t=r.parent(),i=t.parent(),u;t.hasClass("collapsed")?(u=!0,t.animate({height:r.next().children().length*24+20},200,function(){var n=i.scrollTop(),u=r.position().top;t.height()>i.height()?i.scrollTop(n+u-80):i.scrollTop(n+u-i.height()+t.height())}),t.removeClass("collapsed")):(t.animate({height:20},200),t.addClass("collapsed"))},CourseInfo.prototype.fade=function(){$(this.placeholder).css("background-color","transparent"),$(this.placeholder).css("border-color","transparent"),$(this.placeholder).children(".wrapper").css("overflow-y","hidden"),$(programInfo.placeholder).css("opacity","0.0"),$(this.placeholder).children(".wrapper").children().css("opacity","0.0"),$(".sectionDiv").css("opacity","0.8"),$(".sectionDiv").css("background-color","white")},CourseInfo.prototype.notFade=function(){$(this.placeholder).css("background-color","white"),$(this.placeholder).children(".wrapper").css("overflow-y","auto"),$(programInfo.placeholder).css("opacity","1.0"),$(this.placeholder).children(".wrapper").children().css("opacity","1.0"),$(this.placeholder).css("border-color","#ddd"),$(".sectionDiv").css("opacity","1.0")},CourseInfo.prototype.getHtml=function(n){var i,r,u,t;for(this.notFade(),$(this.placeholder).hide(),i="<div class='wrapper'><div id='courseInfoTitle'><b>"+n.Abbr+": "+n.Name+"<\/b><\/div>",n.Description&&(i+="<div class='courseInfoDescription'>"+n.Description+"<\/div>"),i+="<div class='sectionDiv'><div id='courseInfoLectureSections'><b>Lecture Sections:<\/b>",r=0,t=0;t<n.Sections.length;t++)n.Sections[t].IsLecture&&(i+="<div class='section' order="+t+">"+n.Sections[t].Name+"<\/div>",r++);if(i+="<\/div>",r<n.Sections.length){for(i+="<div id='courseInfoOtherSections'><b>Tutorials and Labs:<\/b>",t=0;t<n.Sections.length;t++)n.Sections[t].IsLecture||(u=this.getSectionObject(t,0),i+="<div class='section' order="+t+">"+n.Sections[t].Name+"<\/div>");i+="<\/div>"}for(i+="<\/div>",i+="<div class='courseInfoDescription'><b>Instructor: <\/b>",t=0;t<n.Sections.length;t++)n.Sections[t].IsLecture&&n.Sections[t].Instructor!==""&&(i+=n.Sections[t].Instructor+" ("+n.Sections[t].Name+") ");return i+="<\/div>",n.Prerequisites&&(i+="<div class='courseInfoDescription'><b>Prerequisites: <\/b>"+n.Prerequisites+"<\/div>"),n.Corequisites&&(i+="<div class='courseInfoDescription'><b>Corequisites: <\/b>"+n.Corequisites+"<\/div>"),n.Exclusions&&(i+="<div class='courseInfoDescription'><b>Exclusions: <\/b>"+n.Exclusions+"<\/div>"),n.BreadthRequirement&&(i+="<div class='courseInfoDescription'><b>Breadth: <\/b>"+n.BreadthRequirement+"<\/div>"),n.DistributionRequirement&&(i+="<div class='courseInfoDescription'><b> Distribution: <\/b>"+n.DistributionRequirement+"<\/div>"),i+="<\/div>",setTimeout(function(){$(this.placeholder).show("slide",200)}.bind(this),200),i},CourseInfo.prototype.addSection=function(n,t){var f,e,r,u,i;if(t&&this.notFade(),t&&calendar.tempRemove(),!($(".cal"+this.course.ID+this.course.Sections[n].Name).length>0)){if(f=this.course.Sections[n].ParsedTime.MeetTimes,e=this.course.ID+this.course.Sections[n].Name,f){for(r=this.getSectionObject(n,0,e),u=0;u<f.length;u++)i=this.getSectionObject(n,u,e),i.StartTime<r.StartTime&&(r=i),t?(calendar.addItem(i),coursesList.addItem(i),refreshCookie()):calendar.tempAdd(i);setTimeout(function(){calendar.scrollForItem(r)},300)}t&&this.refreshConflict()}},CourseInfo.prototype.removeSection=function(n){if(this.notFade(),$(".cal"+this.course.ID+this.course.Sections[n].Name).length!=0){var t=this.course.ID+this.course.Sections[n].Name;calendar.removeItem(t),coursesList.removeItem(t),refreshCookie()}},CourseInfo.prototype.getSectionObject=function(n,t,i){return getSectionObject(this.course,n,t,i)},CourseInfo.prototype.refreshConflict=function(){var n,f,t,i,r,u,e;for($sections=$(".section"),n=0;n<$sections.length;n++)if(f=$($sections[n]).attr("order"),t=this.course.Sections[f],t.ParsedTime.MeetTimes){for(i=!1,r=!1,u=0;u<t.ParsedTime.MeetTimes.length;u++)e=this.getSectionObject(f,u,this.course.ID+t.Name),calendar.isConflicted(e)&&(i=!0),calendar.hasItem(e)&&(r=!0);r&&!$($sections[n]).hasClass("added")?$($sections[n]).addClass("added"):!r&&$($sections[n]).hasClass("added")&&$($sections[n]).removeClass("added"),i&&!$($sections[n]).hasClass("conflict")?$($sections[n]).addClass("conflict"):!i&&$($sections[n]).hasClass("conflict")&&$($sections[n]).removeClass("conflict")}},ProgramInfo.prototype.getHtml=function(){},ProgramInfo.prototype.loadSearches=function(n){loadingOff(),$("#programSearchResult").html(n.Matches),$(".programResult").click(function(n){searchProgramInfo($(n.target).attr("id"))}),$("#programSearchResult").show(),$("#programDetail").hide()},ProgramInfo.prototype.loadProgram=function(n){var t="";t+="<div id='programTitle'><b>"+n.Name+"<\/b><\/div><div id='back'>Back<\/div>",t+="<div id='programDescription'>"+n.Description+"<\/div>",$("#programDetail").html(t),$("#programSearchResult").hide(),$("#programDetail").show(),$("#back").click(function(){this.goBack()}.bind(this))},ProgramInfo.prototype.goBack=function(){$("#programSearchResult").show(),$("#programDetail").hide()},CoursesList.prototype.removeCourse=function(n){calendar.removeCourse(n),delete this.courses[n],this.refreshCredit(),this.refreshHtml(),courseInfo&&courseInfo.refreshConflict(),refreshCookie()},CoursesList.prototype.addItem=function(n){if($("#list"+n.ID).length==0){var t=n.ID;this.courses[n.CourseID]?(this.courses[n.CourseID].Items[t]=n,this.refreshHtml()):(this.courses[n.CourseID]={},this.courses[n.CourseID].Semester=n.Semester,this.courses[n.CourseID].Items={},this.courses[n.CourseID].Items[t]=n,this.refreshHtml(),this.refreshCredit())}},CoursesList.prototype.refreshCredit=function(){this.creditCount=0,this.courseCount=0;for(var n in this.courses)this.creditCount+=this.courses[n].Semester=="Y"?1:.5,this.courseCount++;this.creditCount===0?$("#coursesListTitle").html(""):$("#coursesListTitle").html(this.courseCount+" course"+(this.courseCount==1?"":"s")+" added.  "+this.creditCount+" credit"+(this.creditCount<=1?"":"s")+".")},CoursesList.prototype.getHtml=function(n){return"<li id='list"+n.ID+"'><div class='listItem' onClick=''>"+n.Abbr+"<\/div><div class='delete' onClick=''>Delete<\/div><\/li>"},CoursesList.prototype.refreshHtml=function(){var u=$(this.placeholder).children("#courseList"),n,f,t,r,i;u.html("");for(n in this.courses){for(f in this.courses[n].Items)break;t="";for(r in this.courses[n].Items)t+=t===""?this.courses[n].Items[r].SectionName:", "+this.courses[n].Items[r].SectionName;t="Sections: "+t,i=this.courses[n].Items[f],u.append($("<div class='listItem' id='listItem"+i.CourseID+"'><\/div>").data("id",i.CourseID).html("<div class='listItem-title'>"+i.ShortName+"<\/div><div class='delete'><\/div><div>"+t+"<\/div>"))}$(".listItem").on("mouseenter",function(){$(this).find(".delete").show()});$(".delete").on("click",function(n){this.removeCourse($(n.target).parent().data("id"))}.bind(this));$(".listItem").on("mouseleave",function(){$(this).find(".delete").hide()});$(".listItem").on("click",function(n){$(n.target).hasClass("delete")||($(this).hasClass("selected")?$(document).click():(searchCourseInfo("c"+$(this).data("id"),this),$(this).parent().children(".selected").removeClass("selected"),$(this).addClass("selected"),calendar.highlight($(this).data("id"))))})},CoursesList.prototype.removeItem=function(n){var r,i,t,u;if(calendar.removeItem(n),courseInfo&&courseInfo.refreshConflict(),refreshCookie(),r=/([0-9]+)([A-Z]+[0-9]+)/,i=r.exec(n),i&&(t=i[1],this.courses[t])){delete this.courses[t].Items[n];for(u in this.courses[t].Items)break;u||delete this.courses[t]}this.refreshHtml(),this.refreshCredit()};
//@ sourceMappingURL=Default.min.js.map